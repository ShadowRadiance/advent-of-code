import { assertEquals } from "@std/assert";
import { heredoc } from "../../lib/heredoc.ts";

import { parseInput, part_1, part_2 } from "./index.ts";
import { Machine } from "./machine.ts";

const data = heredoc(`
  [.##.] (3) (1,3) (2) (2,3) (0,2) (0,1) {3,5,4,7}
  [...#.] (0,2,3,4) (2,3) (0,4) (0,1,2) (1,2,3,4) {7,5,12,7,2}
  [.###.#] (0,1,2,3,4) (0,3,4) (0,1,2,4,5) (1,2) {10,11,11,5,10,5}
`);

Deno.test("parseInput parses the input into the correct structure", () => {
  const expected = [
    new Machine("[.##.] (3) (1,3) (2) (2,3) (0,2) (0,1) {3,5,4,7}"),
    new Machine("[...#.] (0,2,3,4) (2,3) (0,4) (0,1,2) (1,2,3,4) {7,5,12,7,2}"),
    new Machine(
      "[.###.#] (0,1,2,3,4) (0,3,4) (0,1,2,4,5) (1,2) {10,11,11,5,10,5}",
    ),
  ];

  const results = parseInput(data);

  assertEquals(results, expected);
});

Deno.test("part_1 returns the correct answer for the example", () => {
  assertEquals(part_1(data), "7");
});

Deno.test("part_2 returns the correct answer for the example", () => {
  assertEquals(part_2(data), "33");
});

// PART TWO:
// TEST
// [ 3, 5, 4, 7 ]                           => 10
// [ 7, 5, 12, 7, 2 ]                       => 12
// [ 10, 11, 11, 5, 10, 5 ]                 => 11
// LIVE CORRECT ANSWERS (FROM LINEAR SOLUTION)
// [29,40,23,42,39,52]                      => 71
// [237,230,49,207,213,228,221,72,200]      => 267
// [40,25,40,35,11,33,20]                   => 56
// [69,38,26,29,38,36,60,45]                => 70
// [37,37,23,36,43,37,55]                   => 65
// [13,51,33,21,52,37,56,56,26,48]          => 88
// [78,34,49,55,40,36,73,22,38]             => 97
// [37,13,46,38,51,118,170,30]              => 196
// [0,17,0,17]                              => 17
// [41,46,39,57,30,52,20,50,44,26]          => 76
// [29,28,52,49,56,57,52,42,42]             => 89
// [9,74,62,55,41,43,58,68,35]              => 80
// [48,67,65,30,85,51,90,65,63,35]          => 91
// [66,19,82,59,34,43,40,71]                => 100
// [27,2,18,11]                             => 29
// [168,168,27,171,29,27]                   => 195
// [192,24,26,218,26]                       => 218
// [38,35,32,49,10,47,11,25]                => 72
// [19,41,24,8,36,31,36,19,27]              => 68
// [48,42,54,27,48,66,42,67,50,68]          => 125
// [11,16,119,10,5,11]                      => 119
// [4,30,30,28]                             => 36
// [20,83,36,55,47,43,59,59,47,50]          => 94
// [36,40,29,86,59,61,92]                   => 92
// [12,8,20,20]                             => 20
// [35,19,6,20,8,21,16]                     => 38
// [51,45,34,43,51]                         => 65
// [49,62,40,71,36,62,37]                   => 86
// [21,23,21,27]                            => 48
// [16,3,10,3,25,16]                        => 27
// [220,207,13,225,207,48]                  => 240
// [49,49,19,29,73,52,64]                   => 97
// [58,62,56,43,76,57,62,72,56]             => 95
// [44,13,44,29,36,18,13]                   => 49
// [39,66,83,50,46,58,65,66]                => 102
// [40,3,28,38,48,31,35]                    => 48
// [29,231,47,183,51,40,28,47,174]          => 258
// [37,31,33,44,48,45]                      => 84
// [16,29,35,21,22,14]                      => 51
// [20,13,13,10,39]                         => 39
// [196,242,203,52,209,51,206,50,50]        => 250
// [136,11,152,147,145,143]                 => 156
// [0,23,12,23]                             => 23
// [20,24,43,29,6,27]                       => 44
// [21,31,20,46]                            => 52
// [156,173,6,23]                           => 179
// [51,47,81,62,28,36,81,33]                => 100
// [53,25,7,33,35,25,26,49]                 => 56
// [43,30,22,13,39,48,20,13]                => 51
// [17,21,5,31,33,26,33]                    => 52
// [37,44,45,36,40,45]                      => 56
// [5,24,24,38]                             => 43
// [48,27,44,30,35,57,77,56,42,43]          => 98
// [48,40,99,48,42,51,71,38,46,28]          => 108
// [49,25,7,6,35,32,23]                     => 69
// [37,51,38,64,44,82,28,92]                => 109
// [36,22,25,40,15,27,27,7,17]              => 70
// [42,43,66,75,9,16,43,19]                 => 94
// [7,24,159,183]                           => 183
// [38,64,88,88,90,79,34,84,72,55]          => 148
// [49,187,192,32,190,25,192,175]           => 224
// [47,66,54,38,24,61,61,73]                => 93
// [54,18,58,60,22]                         => 76
// [85,56,69,89,55,53,89,39,50]             => 120
// [43,64,28,62,43,65,45,30,41]             => 79
// [18,146,38,150,29,142]                   => 163
// [214,182,191,188,29]                     => 217
// [40,16,28,18,21,21,22]                   => 50
// [44,59,42,13,28]                         => 85
// [230,200,239,18,21,40,230,200]           => 239
// [29,19,15,29,44]                         => 44
// [37,19,38,56,38,29,57,36,29,36]          => 93
// [45,50,24,39,52,19]                      => 80
// [25,75,77,55,38,54]                      => 95
// [50,54,19,15,35,1,19,54]                 => 70
// [31,36,16,54]                            => 54
// [52,60,52,68,34,74,56,62]                => 87
// [27,158,165,11]                          => 176
// [46,51,52,56,26,75,62,27,15]             => 86
// [71,92,78,72,70,71,74,74,58]             => 104
// [5,13,18,18]                             => 18
// [21,27,187,39,52,29,192,185,33]          => 218
// [23,26,29,36]                            => 49
// [15,28,28,15,33]                         => 43
// [29,49,56,39,71,66,47,53,54]             => 96
// [13,51,57,52,25,57,89,32,49,41]          => 93
// [30,25,25,50,35,65]                      => 75
// [43,38,39,42,36,78]                      => 82
// [13,33,29,12,27,24,11,6,11,30]           => 63
// [16,24,18,19,14]                         => 43
// [26,29,50,38,51,17,26,49,48]             => 62
// [47,48,36,10]                            => 57
// [76,57,12,75,71,37,57,72,72,41]          => 100
// [35,12,37,20,13]                         => 48
// [28,19,44,31,57,37,51]                   => 70
// [23,27,27,34,23]                         => 42
// [181,28,17,167,168,14,175,18,19,20]      => 200
// [35,37,32,14,21]                         => 51
// [225,245,252,241,236,4,221,41,221,237]   => 277
// [64,46,36,47,13,27,46,26,46,29]          => 64
// [19,11,29,26]                            => 30
// [90,44,21,55,68,67,74,30,65,77]          => 119
// [37,20,14,17,28]                         => 48
// [89,47,29,76,86,51,79,46,73,73]          => 131
// [180,32,158,13,177]                      => 190
// [60,53,44,54]                            => 79
// [35,17,32,11,21,17,46,20,25]             => 87
// [30,23,23,30,17,6]                       => 30
// [233,213,58,252,79,43,217,229,225,248]   => 274
// [36,35,27,26,37,42]                      => 68
// [186,11,1,1,191,6,190]                   => 197
// [152,145,145,18,11]                      => 163
// [41,23,44,184,49,31,64]                  => 192
// [9,55,28,35,35,35,26]                    => 55
// [35,23,27,37,5,36,37]                    => 59
// [31,47,35,41,61,52,61,28,18]             => 68
// [33,43,28,146,133,26,143]                => 164
// [52,28,52,40,57,39,32,13]                => 60
// [1,34,16,30]                             => 40
// [21,8,44,63,50,45,21]                    => 63
// [34,34,74,53,39]                         => 74
// [60,87,51,80,84,51,52,89,76]             => 122
// [15,10,10,11,12,16]                      => 27
// [29,1,45,64,51,47,58,63,58,54]           => 68
// [86,252,277,248,54,265,68,249,55,41]     => 300
// [152,151,161,22,146,161,15]              => 167
// [50,83,55,62,49,58,35,42,43]             => 97
// [188,54,82,195,156,69,54,144,175,150]    => 224
// [20,29,20,30,49,21,29,55,38,32]          => 77
// [202,53,52,57,56,25]                     => 207
// [171,148,78,203,177,166,188,43,201,191]  => 257
// [11,14,40,14,27]                         => 41
// [26,32,47,29]                            => 61
// [41,61,208,189,59,11]                    => 220
// [44,26,29,42,44,25]                      => 44
// [59,49,26,34,68,29,19]                   => 79
// [32,38,61,49,54,50,51,33,87]             => 95
// [86,99,85,62,76,67,38,52,80]             => 126
// [36,21,74,46,44,42,56,25,57]             => 81
// [59,50,35,35,61,14,45,44]                => 98
// [30,46,55,36,17,27]                      => 63
// [77,22,41,39,43,15]                      => 77
// [217,11,52,175,51,50]                    => 217
// [20,40,29,72,43,17,67]                   => 84
// [16,7,9,7]                               => 16
// [66,32,53,36,24,32,80]                   => 87
// [51,52,20,112,84,50,34,47,47,64]         => 135
// [48,245,296,279,284,100,262,232,297,264] => 334
// [27,35,16,1,15,45,25,29,39]              => 68
// [198,20,20,8,22,20,200,210]              => 229
// [150,152,77,185,164,17,139,168]          => 201
// [21,21,5,133,128,5]                      => 133
// [14,24,55,21,34,38,45,22,50]             => 73
// [32,26,32,29,32,32,22]                   => 55
// [174,54,19,202,47,53,49,23]              => 221
// [19,20,13,23,7]                          => 24
// [58,76,229,229,264,55,220,227]           => 276
// [196,6,193,3,14]                         => 203
// [189,191,191,2]                          => 191
// [60,49,46,18,45,18,45,38,30]             => 68
// [177,195,15,190,195,180,190]             => 210
// [46,67,40,39,47]                         => 67
// [55,32,12,33,22,30,23]                   => 65
// [79,91,67,84,9,58,64,89,96,31]           => 123
// [128,145,145,128,118,6]                  => 145
// [28,21,53,35,43,61,47]                   => 75
// [47,19,176,68,31,208]                    => 245
// [20,42,29,32,28,20,40,37]                => 57
// [24,24,8,24]                             => 24
// [39,11,10,18]                            => 39
// [109,31,47,47,62,95,86,61,95,60]         => 125
// [77,46,36,64,49,84,85,41,59,61]          => 92
// [14,12,5,10,16,14]                       => 19
// [61,26,37,36,25,23,17,3,15,33]           => 75
// [195,39,214,225,26,205]                  => 226
// [197,187,34,33]                          => 209
// [13,48,17,32,41,28,7]                    => 53
// [199,33,198,182]                         => 215
// [140,165,188,164,53,44,29,153]           => 207
